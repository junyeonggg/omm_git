<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Title</title>
    <script src="https://js.tosspayments.com/v2/standard"></script>
    <script th:src="@{/js/order.js}"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <!-- 브랜드명이나 로고 -->
        <a class="navbar-brand" href="/">Your Brand</a>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <!-- 중앙에 위치한 항목 (예: 네비게이션 링크) -->
            <ul class="navbar-nav me-auto">
                <!-- 여기에 다른 네비게이션 항목이 있을 수 있습니다 -->
            </ul>
            <!-- 오른쪽에 위치한 로그인/회원가입 버튼 -->
            <ul class="navbar-nav">
                <li sec:authorize="isAnonymous()" class="nav-item"><a class="nav-link active" aria-current="page" th:href="@{/login}">로그인</a></li>
                <li sec:authorize="isAnonymous()" class="nav-item"><a class="nav-link" th:href="@{/join}">회원가입</a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- 상품 정보 영역-->
<div class="title">상품 정보</div>
<p>토스 티셔츠</p>
<p>결제 금액: 15,000원</p>
<form id="discount-coupon">
    <input type="checkbox" id="coupon"/>5,000원 할인받기
</form>

<!-- 결제 방법 영역-->
<div class="title">결제 방법</div>
<div id="payment-method"></div>
<div id="agreement"></div>

<!-- 결제 버튼 -->
<button class="button" onclick="requestPayment()">결제하기</button>
<footer class="py-5 bg-dark">
    <div class="container"><p class="m-0 text-center text-white">&copy; Your Website 2023</p></div>
</footer>
</body>
<script>
      // ------  SDK 초기화 ------
      // @docs https://docs.tosspayments.com/sdk/v2/js#토스페이먼츠-초기화
      const clientKey = "";
      const customerKey = "";
      // 회원 결제
      // @docs https://docs.tosspayments.com/sdk/v2/js#tosspaymentspayment
      const tossPayments = TossPayments(clientKey);
      const payment = tossPayments.payment({ customerKey });
      // 비회원 결제
      // const payment = tossPayments.payment({customerKey: TossPayments.ANONYMOUS})

      // ------ '결제하기' 버튼 누르면 결제창 띄우기 ------
      // @docs https://docs.tosspayments.com/sdk/v2/js#paymentrequestpayment
        async function requestPayment() {
        // 결제를 요청하기 전에 orderId, amount를 서버에 저장하세요.
        // 결제 과정에서 악의적으로 결제 금액이 바뀌는 것을 확인하는 용도입니다.
        await payment.requestPayment({
          method: "CARD", // 카드 및 간편결제
          amount: {
            currency: "KRW",
            value: 50000,
          },
          orderId: "nD3fNVLGLMAEohUQe6_Rd", // 고유 주분번호
          orderName: "토스 티셔츠 외 2건",
          successUrl: window.location.origin + "/success", // 결제 요청이 성공하면 리다이렉트되는 URL
          failUrl: window.location.origin + "/fail", // 결제 요청이 실패하면 리다이렉트되는 URL
          customerEmail: "customer123@gmail.com",
          customerName: "김토스",
          customerMobilePhone: "01012341234",
          // 카드 결제에 필요한 정보
          card: {
            useEscrow: false,
            flowMode: "DIRECT", // 자체창 여는 옵션
            // cardCompany: "삼성", // 카드사 자체창
            easyPay: "토스페이", // 간편결제 자체창
            useCardPoint: false,
            useAppCardOnly: false,
          },
        });
      }
</script>
</html>